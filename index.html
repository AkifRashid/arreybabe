<!DOCTYPE html>
<html lang="en">
<head>
<!-- VERSION: 2024-mobile-optimized-v5 -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For Reem</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Special+Elite&family=Caveat:wght@400;600&family=Playfair+Display:ital,wght@0,400;1,400&display=swap');
  body {
  overflow-y: auto;
}

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #111;
    color: #2c2c2c;
    font-family: 'Special Elite', cursive;
    overflow-x: hidden;
overflow-y: auto;
  }

  /* ??? GRAIN ??? */
  .grain-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    pointer-events: none;
    z-index: 100;
    opacity: 1;
  }
  .grain-overlay canvas { width: 100%; height: 100%; }

  /* ??? SCREENS ??? */
  .screen {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 100px 32px;          /* ? was 60px 20px */
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s ease, transform 0.8s ease;
    position: relative;
  }
  .screen.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* ??? SCREEN 1: CASSETTE ??? */
  .cassette-screen {
    background: #111;
    flex-direction: column;
    gap: 34px;                    /* ? was 30px */
  }
  .cassette-title {
    font-family: 'Caveat', cursive;
    color: #d4a574;
    font-size: 38px;              /* ? was 32px */
    text-align: center;
    letter-spacing: 3px;
  }
  .cassette {
    width: 380px;                 /* ? was 340px */
    max-width: 92vw;
    height: 230px;                /* ? was 210px */
    background: linear-gradient(145deg, #2a2a2a, #1f1f1f);
    border-radius: 14px;
    border: 2px solid #3a3a3a;
    position: relative;
    box-shadow: 0 8px 32px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 14px;
  }
  .cassette-label {
    position: absolute;
    top: 16px;
    left: 50%;
    transform: translateX(-50%);
    width: 256px;                 /* ? was 230px */
    height: 50px;                 /* ? was 46px */
    background: #f5e6d3;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .cassette-label span {
    font-family: 'Caveat', cursive;
    font-size: 20px;              /* ? was 16px */
    color: #8b6914;
    font-weight: 600;
  }
  .reels {
    display: flex;
    gap: 72px;                    /* ? was 70px */
    margin-top: 12px;
  }
  .reel {
    width: 54px;                  /* ? was 50px */
    height: 54px;
    border-radius: 50%;
    background: #111;
    border: 3px solid #3a3a3a;
    position: relative;
    overflow: hidden;
  }
  .reel::after {
    content: '';
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 16px; height: 16px;   /* ? was 14px */
    border-radius: 50%;
    background: #222;
    border: 2px solid #444;
  }
  .reel.spinning { animation: spin 1.2s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }

  .play-btn {
    width: 62px; height: 62px;   /* ? was 58px */
    border-radius: 50%;
    background: #d4a574;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 14px rgba(0,0,0,0.5);
    transition: transform 0.2s, background 0.2s;
    margin-top: 4px;
  }
  .play-btn:hover { background: #c49a6c; transform: scale(1.05); }
  .play-btn svg { width: 24px; height: 24px; fill: #1a1a1a; margin-left: 3px; }

  .scroll-hint {
    font-family: 'Caveat', cursive;
    color: #666;
    font-size: 20px;              /* ? was 18px */
    text-align: center;
    animation: pulse 2s ease-in-out infinite;
  }
  @keyframes pulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 1; }
  }

  /* ??? POLAROID ??? */
  .polaroid-wrap { background: #111; }
  .polaroid {
    background: #fff;
    padding: 26px 26px 62px;     /* ? was 22px 22px 56px */
    box-shadow: 0 8px 30px rgba(0,0,0,0.5), 2px 2px 0 rgba(0,0,0,0.15);
    max-width: 400px;             /* ? was 360px */
    width: 100%;
    position: relative;
  }
  .polaroid.rot-r { transform: rotate(1.5deg); }
  .polaroid.rot-l { transform: rotate(-1.8deg); }
  .polaroid.rot-0 { transform: rotate(0deg); }
  .polaroid-img {
    width: 100%;
    background: #e8ddd0;
    border: 1px solid #ddd;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .polaroid-text-inner {
    padding: 38px 28px;           /* ? was 34px 24px */
    text-align: center;
  }
  .polaroid-caption {
    position: absolute;
    bottom: 18px;                 /* ? was 16px */
    left: 0; right: 0;
    text-align: center;
    font-family: 'Caveat', cursive;
    font-size: 20px;              /* ? was 19px */
    color: #5a4a3a;
  }
  .tape-strip {
    position: absolute;
    top: -12px;
    left: 50%;
    transform: translateX(-50%);
    width: 88px; height: 26px;   /* ? was 80px 24px */
    background: rgba(212, 165, 116, 0.5);
    border-radius: 2px;
  }

  /* ??? PAPER NOTE ??? */
  .paper-wrap { background: #111; }
  .paper {
    background: #f4efe8;
    padding: 30px 34px 40px;     /* top = 30px = one rule cycle, first baseline lands on first line */
    max-width: 420px;
    width: 100%;
    position: relative;
    box-shadow: 0 6px 26px rgba(0,0,0,0.5);
    border-radius: 2px;
  }
  .paper-lines {
    background: repeating-linear-gradient(
      transparent,
      transparent 29px,
      #d6c9b0 29px,
      #d6c9b0 30px                /* rule cycle = 30px */
    );
  }
  .paper-text {
    font-family: 'Caveat', cursive;
    font-size: 26px;
    line-height: 30px;            /* matches rule cycle exactly */
    color: #e8e0d0;               /* almost white/cream for excellent readability */
    position: relative;
    z-index: 1;
  }
  .paper-pin {
    position: absolute;
    top: -9px; left: 50%;
    transform: translateX(-50%);
    width: 22px; height: 22px;   /* ? was 20px */
    border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #e8a0a0, #c44);
    box-shadow: 0 2px 5px rgba(0,0,0,0.4);
  }

  /* ??? SCREEN 4: INTERACTIVE CASSETTE LABEL ??? */
  .cassette-label-screen { background: #111; }
  .label-card {
    background: #f5e6d3;
    width: 380px;
    max-width: 92vw;
    padding: 42px 32px 38px;
    border-radius: 6px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.6);
    position: relative;
    text-align: center;
    z-index: 10;                   /* increased to ensure it sits above the flower layer */
  }
  .label-card::before {
    content: '?';
    position: absolute;
    top: 14px; right: 18px;
    font-size: 24px;              /* ? was 22px */
    color: #c49a6c;
    opacity: 0.6;
    z-index: 2;
  }
  .label-title {
    font-family: 'Special Elite', cursive;
    font-size: 13px;
    color: #8b6914;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 8px;
    position: relative;
    z-index: 2;
  }
  .label-song-title {
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 28px;
    color: #5a3e10;
    margin-bottom: 24px;
    position: relative;
    z-index: 2;
  }

  /* Screen 4 play button */
  .label-play-btn {
    width: 56px; height: 56px;
    border-radius: 50%;
    background: #c49a6c;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    box-shadow: 0 4px 16px rgba(0,0,0,0.4);
    transition: transform 0.2s, background 0.2s, box-shadow 0.3s;
    position: relative;
    z-index: 2;
  }
  .label-play-btn:hover { background: #b08858; transform: scale(1.06); }
  .label-play-btn .icon-play  { display: block; }
  .label-play-btn .icon-pause { display: none; }
  .label-play-btn.playing .icon-play  { display: none; }
  .label-play-btn.playing .icon-pause { display: block; }
  .label-play-btn svg { width: 20px; height: 20px; fill: #fff; }
  .label-play-btn .icon-play { margin-left: 2px; }

  /* Flower layer — covers the full dark background behind the card */
  .flower-layer {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 1;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.8s ease;
  }
  .flower-layer.visible { opacity: 1; }
  .flower-layer svg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

  /* Each petal/stem path animates its length in */
  .f-path {
    fill: none;
    stroke: rgba(255,255,255,0.85);
    stroke-width: 2.5;
    stroke-linecap: round;
    stroke-linejoin: round;
    stroke-dasharray: 1200;       /* large enough to exceed every path in the SVG */
    stroke-dashoffset: 1200;      /* fully hidden at start */
    transition: stroke-dashoffset 2.2s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .f-path.drawn { stroke-dashoffset: 0; }
  
  /* Make flowers even more visible on mobile */
  @media (max-width: 768px) {
    .f-path {
      stroke-width: 3;
      stroke: rgba(255,255,255,0.9);
    }
  }

  /* "I love you" — slides up after flowers */
  .love-reveal {
    position: relative;
    z-index: 2;
    margin-top: 22px;
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    transition: max-height 0.8s cubic-bezier(0.4, 0, 0.2, 1),
                opacity    0.6s ease 0.2s;
  }
  .love-reveal.open {
    max-height: 80px;
    opacity: 1;
  }
  .love-reveal span {
    font-family: 'Caveat', cursive;
    font-size: 34px;
    color: #4a3520;
    letter-spacing: 1px;
  }

  /* Moon layer for Screen 8 */
  .moon-layer {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 1;
    pointer-events: none;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 80px;
    opacity: 0;
    transition: opacity 1s ease;
  }
  .moon-layer.visible { opacity: 1; }
  .moon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: transparent;
    border: 2px solid rgba(255,255,255,0.9);
    box-shadow: 0 0 20px rgba(255,255,255,0.4);
    transition: transform 2s ease, width 2s ease, height 2s ease;
    position: relative;
  }
  .moon.growing {
    width: 140px;
    height: 140px;
  }
  
  /* Stars scattered around */
  .star {
    position: absolute;
    width: 3px;
    height: 3px;
    background: white;
    border-radius: 50%;
    opacity: 0;
    transition: opacity 1.5s ease;
    box-shadow: 0 0 4px rgba(255,255,255,0.8);
  }
  .moon-layer.visible .star {
    opacity: 0.9;
  }
  .star:nth-child(2) { top: 20%; left: 15%; animation: twinkle 3s infinite; }
  .star:nth-child(3) { top: 35%; left: 25%; animation: twinkle 4s infinite 0.5s; }
  .star:nth-child(4) { top: 15%; left: 70%; animation: twinkle 3.5s infinite 1s; }
  .star:nth-child(5) { top: 45%; left: 80%; animation: twinkle 4.5s infinite 1.5s; }
  .star:nth-child(6) { top: 65%; left: 20%; animation: twinkle 3s infinite 2s; }
  .star:nth-child(7) { top: 75%; left: 75%; animation: twinkle 4s infinite 0.8s; }
  .star:nth-child(8) { top: 85%; left: 35%; animation: twinkle 3.5s infinite 1.2s; }
  .star:nth-child(9) { top: 55%; left: 90%; animation: twinkle 4s infinite 0.3s; }
  
  @keyframes twinkle {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 1; }
  }
  
  /* Mobile adjustments */
  @media (max-width: 768px) {
    .moon-layer {
      padding-right: 40px;
    }
    .moon {
      width: 60px;
      height: 60px;
      border-width: 3px;
    }
    .moon.growing {
      width: 100px;
      height: 100px;
    }
    .star {
      width: 4px;
      height: 4px;
    }
  }

  /* ??? PHOTO FRAME ??? */
  .photo-wrap { background: #111; }
  .photo-frame {
    border: 8px solid #e8ddd0;    /* ? was 7px */
    box-shadow: 0 8px 28px rgba(0,0,0,0.6), inset 0 0 0 1px #c9b99a;
    max-width: 400px;             /* ? was 360px */
    width: 100%;
    background: #fff;
    padding: 16px 16px 54px;     /* ? was 14px 14px 50px */
    position: relative;
  }
  .photo-placeholder {
    width: 100%;
    aspect-ratio: 4/3;
    background: #d5c9b8;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #8a7e6e;
    font-size: 16px;              /* ? was 15px */
    font-family: 'Special Elite', cursive;
  }
  .photo-frame-caption {
    position: absolute;
    bottom: 24px;                 /* increased significantly to move it well below the image */
    left: 0; right: 0;
    text-align: center;
    font-family: 'Caveat', cursive;
    font-size: 20px;              /* ? was 19px */
    color: #5a4a3a;
    padding: 0 20px;              /* added padding to keep text away from edges */
  }

  /* ??? SCREEN 10: FINAL ??? */
  .final-screen {
    background: #111;
    flex-direction: column;
    gap: 28px;                    /* ? was 24px */
    text-align: center;
  }
  .final-card {
    background: #f4efe8;
    padding: 56px 40px;          /* ? was 50px 36px */
    max-width: 420px;             /* ? was 380px */
    width: 100%;
    border-radius: 4px;
    box-shadow: 0 8px 36px rgba(0,0,0,0.6);
    position: relative;
  }
  .final-text {
    font-family: 'Caveat', cursive;
    font-size: 28px;              /* ? was 26px */
    color: #3a3020;
    line-height: 36px;            /* ? was 34px */
  }
  .final-sign {
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 24px;              /* ? was 22px */
    color: #8b6914;
    margin-top: 32px;             /* ? was 28px */
  }
</style>
</head>
<body>

<div class="grain-overlay"><canvas id="grainCanvas"></canvas></div>

<!-- ????????????????????????????????????????????????????????
     SCREEN 1 — Cassette — "Hey, You"
     ???????????????????????????????????????????????????????? -->
<section class="screen cassette-screen visible" id="screen1">
  <div class="cassette-title">For Reem</div>
  <div class="cassette">
    <div class="cassette-label"><span>Hey, You</span></div>
    <div class="reels">
      <div class="reel" id="reel1"></div>
      <div class="reel" id="reel2"></div>
    </div>
    <button class="play-btn" onclick="startExperience()">
      <svg viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"/></svg>
    </button>
  </div>
  <div class="scroll-hint" id="scrollHint" style="opacity:0;">? scroll ?</div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 2 — Polaroid — "I recognised you like a song"
     ???????????????????????????????????????????????????????? -->
<section class="screen polaroid-wrap visible" id="screen2">
  <div style="position:relative;">
    <div class="tape-strip"></div>
    <div class="polaroid rot-l">
      <div class="polaroid-img polaroid-text-inner">
        <p style="font-family:'Caveat',cursive; font-size:24px; color:#3a3020; line-height:30px;">
          I recognised you like a song —<br>
          unknown for a moment,<br>
          in my body before my mind<br>
          had processed it,<br>
          then stuck in my ears.
        </p>
      </div>
      <div class="polaroid-caption">It's the only song that makes me want to dance.</div>
    </div>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 3 — Paper note — TV show metaphor
     ???????????????????????????????????????????????????????? -->
<section class="screen paper-wrap visible" id="screen3">
  <div style="position:relative;">
    <div class="paper-pin"></div>
    <div class="paper paper-lines">
      <p class="paper-text">
        You remind me of what timeless TV shows did. A character fleshed out slowly, until you feel the need to connect with them. Moments of poetic sharpness which leave you stunned and caught in your thoughts. Something to learn, something to laugh about, something to cry over. Cliffhangers which have you coming back every week, staying up a little longer to know more. Humour, drama, lifefulness.
      </p>
    </div>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 4 — Cassette label — "Baby, I'm Yours"
     Interactive: play ? flowers bloom across background ? "I love you" reveals
     ???????????????????????????????????????????????????????? -->
<section class="screen cassette-label-screen visible" id="screen4">

  <!-- Flower layer: fills the full dark background behind the card -->
  <div class="flower-layer" id="flowerLayer">
    <svg viewBox="0 0 800 1400" preserveAspectRatio="xMidYMid meet">
      <!--
        Four botanical clusters positioned in corners, well away from center card.
        White tattoo line-art. stroke-dashoffset animates to 0 on .drawn.
      -->

      <!-- CLUSTER A — bottom-left corner -->
      <path class="f-path" d="M 40,1350 Q 60,1250 100,1170 Q 125,1120 150,1060"/>
      <path class="f-path" d="M 75,1260 Q 40,1230 28,1190 Q 48,1220 75,1260"/>
      <path class="f-path" d="M 95,1190 Q 130,1160 145,1125 Q 120,1155 95,1190"/>
      <path class="f-path" d="M 150,1060 Q 142,1030 150,1000 Q 158,1030 150,1060"/>
      <path class="f-path" d="M 150,1060 Q 120,1040 105,1005 Q 128,1035 150,1060"/>
      <path class="f-path" d="M 150,1060 Q 178,1038 195,1000 Q 168,1035 150,1060"/>
      <path class="f-path" d="M 110,1145 Q 78,1120 68,1085 Q 88,1110 110,1145"/>
      <path class="f-path" d="M 80,1225 Q 55,1205 50,1175 Q 62,1200 80,1225"/>

      <!-- CLUSTER B — top-left corner -->
      <path class="f-path" d="M 30,50 Q 50,130 90,205 Q 115,250 145,300"/>
      <path class="f-path" d="M 62,125 Q 92,110 108,80 Q 85,108 62,125"/>
      <path class="f-path" d="M 80,190 Q 60,215 45,245 Q 68,210 80,190"/>
      <path class="f-path" d="M 145,300 Q 125,282 110,260 Q 128,288 145,300"/>
      <path class="f-path" d="M 145,300 Q 168,280 185,258 Q 160,288 145,300"/>
      <path class="f-path" d="M 145,300 Q 130,322 115,342 Q 135,318 145,300"/>
      <path class="f-path" d="M 145,300 Q 162,325 178,348 Q 155,318 145,300"/>
      <circle class="f-path" cx="145" cy="300" r="5"/>
      <path class="f-path" d="M 100,218 Q 95,198 102,180 Q 108,200 100,218"/>

      <!-- CLUSTER C — top-right corner -->
      <path class="f-path" d="M 760,50 Q 740,140 705,220 Q 680,270 652,325"/>
      <path class="f-path" d="M 735,132 Q 708,118 692,88 Q 715,115 735,132"/>
      <path class="f-path" d="M 718,208 Q 738,235 755,265 Q 732,228 718,208"/>
      <path class="f-path" d="M 652,325 Q 672,308 688,285 Q 670,315 652,325"/>
      <path class="f-path" d="M 652,325 Q 630,310 615,290 Q 638,318 652,325"/>
      <path class="f-path" d="M 652,325 Q 648,305 652,288 Q 656,305 652,325"/>
      <path class="f-path" d="M 690,245 Q 720,228 735,198 Q 708,225 690,245"/>

      <!-- CLUSTER D — bottom-right corner -->
      <path class="f-path" d="M 750,1350 Q 725,1245 688,1160 Q 665,1108 638,1055"/>
      <path class="f-path" d="M 718,1255 Q 748,1225 760,1188 Q 735,1228 718,1255"/>
      <path class="f-path" d="M 695,1175 Q 668,1148 650,1115 Q 678,1155 695,1175"/>
      <path class="f-path" d="M 638,1055 Q 618,1035 602,1010 Q 625,1042 638,1055"/>
      <path class="f-path" d="M 638,1055 Q 660,1032 678,1005 Q 655,1042 638,1055"/>
      <path class="f-path" d="M 638,1055 Q 622,1078 608,1098 Q 632,1072 638,1055"/>
      <path class="f-path" d="M 638,1055 Q 656,1080 672,1102 Q 650,1072 638,1055"/>
      <circle class="f-path" cx="638" cy="1055" r="5"/>
      <path class="f-path" d="M 708,1218 Q 732,1198 742,1165 Q 722,1192 708,1218"/>
    </svg>
  </div>

  <!-- The cassette label card — sits above the flowers -->
  <div class="label-card" id="labelCard4">
    <div class="label-title">Side A — Track 02</div>
    <div class="label-song-title">Baby, I'm Yours</div>

    <button class="label-play-btn" id="playBtn4" onclick="toggleScreen4()">
      <svg class="icon-play"  viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"/></svg>
      <svg class="icon-pause" viewBox="0 0 24 24"><rect x="5" y="3" width="4" height="18"/><rect x="15" y="3" width="4" height="18"/></svg>
    </button>

    <div class="love-reveal" id="loveReveal">
      <span>I love you</span>
    </div>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 5 — Photo frame — [base64 image TBD]
     ???????????????????????????????????????????????????????? -->
<section class="screen photo-wrap visible" id="screen5">
  <div class="photo-frame">
    <img src="assets/64604871-4301-4270-9C9C-BDE8716E6D23_1_105_c.jpeg" style="width:100%; display:block;">
    <div class="photo-frame-caption">Us yesterday, us tomorrow.</div>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 6 — Polaroid — [TBD]
     ???????????????????????????????????????????????????????? -->
<section class="screen polaroid-wrap visible" id="screen6">
  <div style="position:relative;">
    <div class="tape-strip"></div>
    <div class="polaroid rot-r">
      <div class="polaroid-img polaroid-text-inner">
        <p style="font-family:'Caveat',cursive; font-size:24px; color:#3a3020; line-height:30px;">
          You make the pandemonium peaceful, you make the mundane grand. You incessant and violently present in my thoughts. I am content with this.
        </p>
      </div>
      <div class="polaroid-caption">Every storm carries me back to you.</div>
    </div>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 7 — Paper note — [TBD]
     ???????????????????????????????????????????????????????? -->
<section class="screen paper-wrap visible" id="screen7">
  <div style="position:relative;">
    <div class="paper-pin"></div>
    <div class="paper paper-lines">
      <p class="paper-text">Bless old friends – on some days, the only purpose they serve is to remind me I existed before you. Left to my own devices, it feels like I cannot remember what I did with my hands before they held yours, I go down memory lane just to find stories to tell you, I wish to make food only for us to share, I wish to make art just for your analytical mind to consider. I wish to bring every bit of wit and foolishness to bare, just for your laughter. So I remind myself there is a me without you, and that I must be a whole person, just to give you something worthy of love.</p>
    </div>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 8 — Cassette label — Still Mine by Ashley Singh
     ???????????????????????????????????????????????????????? -->
<section class="screen cassette-label-screen visible" id="screen8">
  <!-- Moon background layer with stars -->
  <div class="moon-layer" id="moonLayer">
    <div class="moon" id="moon"></div>
    <div class="star"></div>
    <div class="star"></div>
    <div class="star"></div>
    <div class="star"></div>
    <div class="star"></div>
    <div class="star"></div>
    <div class="star"></div>
    <div class="star"></div>
  </div>

  <!-- The cassette label card -->
  <div class="label-card">
    <div class="label-title">Side B — Track 01</div>
    <div class="label-song-title">Still Mine</div>
    <p style="font-family:'Caveat',cursive; font-size:20px; color:#8b6914; line-height:28px; position:relative; z-index:2; margin-bottom: 20px;">
      Ashley Singh
    </p>

    <button class="label-play-btn" id="playBtn8" onclick="toggleScreen8()">
      <svg class="icon-play"  viewBox="0 0 24 24"><polygon points="5,3 19,12 5,21"/></svg>
      <svg class="icon-pause" viewBox="0 0 24 24"><rect x="5" y="3" width="4" height="18"/><rect x="15" y="3" width="4" height="18"/></svg>
    </button>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 9 — Photo frame — [TBD]
     ???????????????????????????????????????????????????????? -->
<section class="screen photo-wrap visible" id="screen9">
  <div class="photo-frame">
    <img src="assets/F969B116-9A4F-4700-96AE-9190C6185C33_1_105_c.jpeg" style="width:100%; display:block;">
    <div class="photo-frame-caption">We know what our perfect morning looks like, we just need to find our way back.</div>
  </div>
</section>

<!-- ????????????????????????????????????????????????????????
     SCREEN 10 — Final card — signed Akif
     ???????????????????????????????????????????????????????? -->
<section class="screen final-screen visible" id="screen10">
  <div class="final-card">
    <p class="final-text">For everything you are, thank you for letting me love you.</p>
    <div class="final-sign">— Akif</div>
  </div>
</section>

<!-- ???????????????????????????????????????????????????????????????????
     SCRIPTS
     ??????????????????????????????????????????????????????????????????? -->
<script>
// ?? GRAIN ??
const canvas = document.getElementById('grainCanvas');
const ctx = canvas.getContext('2d');
function resizeCanvas() {
  canvas.width  = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

function drawGrain() {
  const w = canvas.width, h = canvas.height;
  const imageData = ctx.createImageData(w, h);
  const d = imageData.data;
  for (let i = 0; i < d.length; i += 4) {
    const v = Math.random() * 40;
    d[i] = d[i+1] = d[i+2] = v;
    d[i+3] = 35 + Math.random() * 30;
  }
  ctx.putImageData(imageData, 0, 0);
  requestAnimationFrame(drawGrain);
}
drawGrain();

// ?? SCROLL FADE-IN ??
const screens = document.querySelectorAll('.screen');
console.log('Found screens:', screens.length);

const observer = new IntersectionObserver((entries) => {
  entries.forEach(e => {
    console.log('Screen intersecting:', e.target.id, e.isIntersecting);
    if (e.isIntersecting) {
      e.target.classList.add('visible');
      console.log('Added visible class to:', e.target.id);
    }
  });
}, { threshold: 0.15 });

screens.forEach(s => {
  if (s.id !== 'screen1') {
    observer.observe(s);
    console.log('Observing:', s.id);
  }
});

// ?? SCREEN 1: start experience ??
function startExperience() {
  document.getElementById('reel1').classList.add('spinning');
  document.getElementById('reel2').classList.add('spinning');
  document.getElementById('scrollHint').style.opacity = '1';

  const s2 = document.getElementById('screen2');
  s2.classList.add('visible');

  setTimeout(() => {
    s2.scrollIntoView({ behavior: 'smooth' });
  }, 600);
}

// ?? SCREEN 4: play / pause toggle ??
const mp3Url = "assets/09 Baby I'm Yours.mp3";
let screen4Audio = null;   // will be an Audio object once MP3 is added
let screen4Playing = false;

function toggleScreen4() {
  const btn    = document.getElementById('playBtn4');
  const flowers = document.getElementById('flowerLayer');
  const reveal  = document.getElementById('loveReveal');

  console.log('Screen 4 toggle clicked. Currently playing:', screen4Playing);
  console.log('Button element:', btn);
  console.log('Flowers element:', flowers);
  console.log('Reveal element:', reveal);

  if (!screen4Playing) {
    // Stop Screen 8 if it's playing
    if (screen8Playing) {
      toggleScreen8();
    }
    
    // ?? PLAY ??
    screen4Playing = true;
    btn.classList.add('playing');
    console.log('Starting Screen 4 playback');

    // 1. Start flowers blooming (staggered)
    flowers.classList.add('visible');
    const paths = flowers.querySelectorAll('.f-path');
    console.log('Found flower paths:', paths.length);
    paths.forEach((p, i) => {
      setTimeout(() => p.classList.add('drawn'), i * 120);
    });

    // 2. Reveal "I love you" after flowers finish (~paths * 120ms + 800ms buffer)
    const revealDelay = paths.length * 120 + 900;
    setTimeout(() => reveal.classList.add('open'), revealDelay);

    // 3. Play MP3
    console.log('Attempting to load audio from:', mp3Url);
    screen4Audio = new Audio(mp3Url);
    screen4Audio.play().then(() => {
      console.log('Screen 4 audio playing successfully');
    }).catch(err => {
      console.error('Screen 4 audio play error:', err);
    });

  } else {
    // ?? PAUSE ??
    screen4Playing = false;
    btn.classList.remove('playing');
    console.log('Pausing Screen 4');

    // reset flowers
    flowers.classList.remove('visible');
    flowers.querySelectorAll('.f-path').forEach(p => p.classList.remove('drawn'));

    // reset reveal
    reveal.classList.remove('open');

    // pause audio
    if (screen4Audio) { screen4Audio.pause(); screen4Audio.currentTime = 0; }
  }
}

// ?? SCREEN 8: play / pause toggle with moon ??
const mp3Url8 = "assets/Ashley_Singh_-_Still_mine_(mp3.pm).mp3";
let screen8Audio = null;
let screen8Playing = false;

function toggleScreen8() {
  const btn = document.getElementById('playBtn8');
  const moonLayer = document.getElementById('moonLayer');
  const moon = document.getElementById('moon');

  console.log('Screen 8 toggle clicked. Currently playing:', screen8Playing);
  console.log('Button element:', btn);
  console.log('Moon layer element:', moonLayer);
  console.log('Moon element:', moon);

  if (!screen8Playing) {
    // Stop Screen 4 if it's playing
    if (screen4Playing) {
      toggleScreen4();
    }
    
    // ?? PLAY ??
    screen8Playing = true;
    btn.classList.add('playing');
    console.log('Starting Screen 8 playback');

    // 1. Show moon layer
    moonLayer.classList.add('visible');
    console.log('Moon layer visible class added');
    
    // 2. Start moon growing after a brief delay
    setTimeout(() => {
      moon.classList.add('growing');
      console.log('Moon growing class added');
    }, 300);

    // 3. Play MP3
    console.log('Attempting to load audio from:', mp3Url8);
    screen8Audio = new Audio(mp3Url8);
    screen8Audio.play().then(() => {
      console.log('Screen 8 audio playing successfully');
    }).catch(err => {
      console.error('Screen 8 audio play error:', err);
    });

  } else {
    // ?? PAUSE ??
    screen8Playing = false;
    btn.classList.remove('playing');
    console.log('Pausing Screen 8');

    // reset moon
    moonLayer.classList.remove('visible');
    moon.classList.remove('growing');

    // pause audio
    if (screen8Audio) { screen8Audio.pause(); screen8Audio.currentTime = 0; }
  }
}

// Confirm all functions loaded
console.log('=== WEBSITE VERSION 3.0 LOADED ===');
console.log('All functions loaded successfully!');
console.log('toggleScreen4 defined:', typeof toggleScreen4);
console.log('toggleScreen8 defined:', typeof toggleScreen8);
console.log('Flowers should be visible with stroke-width: 2');
console.log('Photo caption at bottom: 24px');
console.log('Paper text color: #2a2015');
</script>
</body>
</html>
